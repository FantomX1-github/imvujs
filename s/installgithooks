#!/bin/bash

HERE=`dirname "$0"`/..

set -e

if [ "$1" ]; then
    REPOSITORY_ROOT="$1"
else
    REPOSITORY_ROOT="$HERE"
fi

DOTGIT="$REPOSITORY_ROOT/.git"

if [ -f "$DOTGIT" ]; then
    GITDIR=$REPOSITORY_ROOT/`cat "$DOTGIT" | sed "s/gitdir: //"`
elif [ -d "$DOTGIT" ]; then
    GITDIR="$DOTGIT"
else
    echo "Could not find .git directory.  Is '$REPOSITORY_ROOT' a git repository?"
    exit 1
fi

for hook in $REPOSITORY_ROOT/githooks/*; do
    ln -f $hook "$GITDIR/hooks"
done
